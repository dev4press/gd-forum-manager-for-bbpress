!function(o,a,r){a.wp=a.wp||{},a.wp.gdfar=a.wp.gdfar||{},a.wp.gdfar.manager={shared:{process:function(a){o(".gdfar-action").removeClass("gdfar-is-error"),o(".gdfar-error-message").remove(),o(".gdfar-modal__footer button").attr("disabled",!1),"ok"===a.status?0<a.errors?o.each(a.elements,function(a,r){a=o(".gdfar-action.gdfar-action-"+a);a.addClass("gdfar-is-error"),o(".gdfar-content-wrapper",a).append("<p class='gdfar-error-message'>"+r+"</p>")}):location.reload(!1):"error"===a.status&&alert(a.error)},dialog:function(a,r){o("#gdfar-modal-edit-content").html('<div class="gdfar-dialog-message">'+gdfar_manager_data.message.please_wait+"</div>"),o("#gdfar-modal-edit-title").html(gdfar_manager_data.titles.edit[a]),o(".gdfar-modal__footer button").attr("disabled",!1),MicroModal.show("gdfar-modal-edit",{}),o.ajax({success:function(a){o("#gdfar-modal-edit-content").html(a)},type:"post",dataType:"html",data:{is:gdfar_manager_data.bbpress.is,forum:gdfar_manager_data.bbpress.forum_id,type:a,id:r},url:gdfar_manager_data.ajaxurl+"?action=gdfar_request_edit&_ajax_nonce="+gdfar_manager_data.nonce})}},quick:{dialog:function(a){a.preventDefault(),wp.gdfar.manager.shared.dialog("topic",o(this).data("id"))}},edit:{dialog:function(a){a.preventDefault();var r=o(this).closest(".gdfar-ctrl-wrapper"),a=r.data("type"),r=r.data("id");wp.gdfar.manager.shared.dialog(a,r)},submit:function(){o(".gdfar-modal__footer button").attr("disabled",!0),o("#gdfar-modal-edit").hasClass("is-open")&&o("#gdfar-manager-form-edit").ajaxSubmit({success:wp.gdfar.manager.shared.process,type:"post",dataType:"json",url:gdfar_manager_data.ajaxurl+"?action=gdfar_process_edit"})}},bulk:{dialog:function(a){a.preventDefault();var r,t=o(this).closest(".gdfar-bulk-control"),e=[],a=t.data("type"),t=t.data("key");o(".gdfar-ctrl-wrapper[data-key="+t+"] input[type=checkbox]:checked").each(function(){e.push(o(this).parent().data("id"))}),o("#gdfar-modal-bulk-content").html('<div class="gdfar-dialog-message">'+gdfar_manager_data.message.please_wait+"</div>"),o("#gdfar-modal-bulk-title").html(gdfar_manager_data.titles.bulk[a]),o(".gdfar-modal__footer button").attr("disabled",!1),MicroModal.show("gdfar-modal-bulk",{}),o.ajax({success:function(a){for(o("#gdfar-modal-bulk-content").html(a),r=0;r<e.length;r++)o("#gdfar-modal-bulk-content form").prepend("<input type='hidden' name='gdfar[id][]' value='"+e[r]+"' />")},type:"post",dataType:"html",data:{is:gdfar_manager_data.bbpress.is,forum:gdfar_manager_data.bbpress.forum_id,type:a,id:e},url:gdfar_manager_data.ajaxurl+"?action=gdfar_request_bulk&_ajax_nonce="+gdfar_manager_data.nonce})},submit:function(){o(".gdfar-modal__footer button").attr("disabled",!0),o("#gdfar-modal-bulk").hasClass("is-open")&&o("#gdfar-manager-form-bulk").ajaxSubmit({success:wp.gdfar.manager.shared.process,type:"post",dataType:"json",url:gdfar_manager_data.ajaxurl+"?action=gdfar_process_bulk"})},update:function(a,r,t){o(".__selected",a).html(r),o(".__total",a).html(t)},select:function(a){a.preventDefault();var r=o(this).hasClass("__all"),a=o(this).closest(".gdfar-bulk-control").data("key");o(".gdfar-ctrl-wrapper[data-key="+a+"] input[type=checkbox]").prop("checked",r).trigger("change")},forum:function(){var a=".gdfar-ctrl-forum .gdfar-ctrl-checkbox",r=o(this).parent(),t=o(this).closest(".bbp-forums"),e=o(".gdfar-bulk-forum-"+r.data("key")),d=o(a+":checked",t).length,r=o(a,t).length;0===d?(o(a,t).removeClass("gdfar-is-on"),e.hide()):(o(a,t).addClass("gdfar-is-on"),e.show(),wp.gdfar.manager.bulk.update(e,d,r))},topic:function(){var a=".gdfar-ctrl-topic .gdfar-ctrl-checkbox",r=o(this).parent(),t=o(this).closest(".bbp-topics"),e=o(".gdfar-bulk-topic-"+r.data("key")),d=o(a+":checked",t).length,r=o(a,t).length;0===d?(o(a,t).removeClass("gdfar-is-on"),e.hide()):(o(a,t).addClass("gdfar-is-on"),e.show(),wp.gdfar.manager.bulk.update(e,d,r))}},init:function(){o(r).on("change",".gdfar-ctrl-topic .gdfar-ctrl-checkbox",wp.gdfar.manager.bulk.topic),o(r).on("change",".gdfar-ctrl-forum .gdfar-ctrl-checkbox",wp.gdfar.manager.bulk.forum),o(r).on("click","#gdfar-modal-edit-submit",wp.gdfar.manager.edit.submit),o(r).on("click","#gdfar-modal-bulk-submit",wp.gdfar.manager.bulk.submit),o(r).on("click",".gdfar-ctrl-wrapper .gdfar-ctrl-edit",wp.gdfar.manager.edit.dialog),o(r).on("click",".gdfar-bulk-control .gdfar-ctrl-bulk",wp.gdfar.manager.bulk.dialog),o(r).on("click",".bbp-topic-quick-edit-link",wp.gdfar.manager.quick.dialog),o(r).on("click",".gdfar-bulk-control a.__all, .gdfar-bulk-control a.__none",wp.gdfar.manager.bulk.select)}},wp.gdfar.manager.init()}(jQuery,window,document);