!function(l,a,r,t){a.wp=a.wp||{},a.wp.gdfar=a.wp.gdfar||{},a.wp.gdfar.manager={shared:{process:function(a){l(".gdfar-action").removeClass("gdfar-is-error"),l(".gdfar-error-message").remove(),l(".gdfar-modal__footer button").attr("disabled",!1),"ok"===a.status?0<a.errors?l.each(a.elements,function(a,r){var t=l(".gdfar-action.gdfar-action-"+a);t.addClass("gdfar-is-error"),l(".gdfar-conent-wrapper",t).append("<p class='gdfar-error-message'>"+r+"</p>")}):location.reload(!1):"error"===a.status&&alert(a.error)}},edit:{dialog:function(a){a.preventDefault();var r=l(this).closest(".gdfar-ctrl-wrapper"),t=r.data("type"),e=r.data("id");l("#gdfar-modal-edit-content").html('<div class="gdfar-dialog-message">'+gdfar_manager_data.message.please_wait+"</div>"),l("#gdfar-modal-edit-title").html(gdfar_manager_data.titles.edit[t]),l(".gdfar-modal__footer button").attr("disabled",!1),MicroModal.show("gdfar-modal-edit",{}),l.ajax({success:function(a){l("#gdfar-modal-edit-content").html(a)},type:"post",dataType:"html",data:{is:gdfar_manager_data.bbpress.is,forum:gdfar_manager_data.bbpress.forum_id,type:t,id:e},url:gdfar_manager_data.ajaxurl+"?action=gdfar_request_edit&_ajax_nonce="+gdfar_manager_data.nonce})},submit:function(){l(".gdfar-modal__footer button").attr("disabled",!0),l("#gdfar-modal-edit").hasClass("is-open")&&l("#gdfar-manager-form-edit").ajaxSubmit({success:wp.gdfar.manager.shared.process,type:"post",dataType:"json",url:ajaxurl+"?action=gdfar_process_edit"})}},bulk:{dialog:function(a){a.preventDefault();var r,t=l(this).closest(".gdfar-bulk-control"),e=[],d=t.data("type"),o=t.data("key");l(".gdfar-ctrl-wrapper[data-key="+o+"] input[type=checkbox]:checked").each(function(){e.push(l(this).parent().data("id"))}),l("#gdfar-modal-bulk-content").html('<div class="gdfar-dialog-message">'+gdfar_manager_data.message.please_wait+"</div>"),l("#gdfar-modal-bulk-title").html(gdfar_manager_data.titles.bulk[d]),l(".gdfar-modal__footer button").attr("disabled",!1),MicroModal.show("gdfar-modal-bulk",{}),l.ajax({success:function(a){for(l("#gdfar-modal-bulk-content").html(a),r=0;r<e.length;r++)l("#gdfar-modal-bulk-content form").prepend("<input type='hidden' name='gdfar[id][]' value='"+e[r]+"' />")},type:"post",dataType:"html",data:{is:gdfar_manager_data.bbpress.is,forum:gdfar_manager_data.bbpress.forum_id,type:d},url:gdfar_manager_data.ajaxurl+"?action=gdfar_request_bulk&_ajax_nonce="+gdfar_manager_data.nonce})},submit:function(){l(".gdfar-modal__footer button").attr("disabled",!0),l("#gdfar-modal-bulk").hasClass("is-open")&&l("#gdfar-manager-form-bulk").ajaxSubmit({success:wp.gdfar.manager.shared.process,type:"post",dataType:"json",url:ajaxurl+"?action=gdfar_process_bulk"})},update:function(a,r,t){l(".__selected",a).html(r),l(".__total",a).html(t)},select:function(a){a.preventDefault();var r=l(this).hasClass("__all"),t=l(this).closest(".gdfar-bulk-control").data("key");l(".gdfar-ctrl-wrapper[data-key="+t+"] input[type=checkbox]").prop("checked",r).trigger("change")},forum:function(){var a=".gdfar-ctrl-forum .gdfar-ctrl-checkbox",r=l(this).parent(),t=l(this).closest(".bbp-forums"),e=l(".gdfar-bulk-forum-"+r.data("key")),d=l(a+":checked",t).length,o=l(a,t).length;0===d?(l(a,t).removeClass("gdfar-is-on"),e.hide()):(l(a,t).addClass("gdfar-is-on"),e.show(),wp.gdfar.manager.bulk.update(e,d,o))},topic:function(){var a=".gdfar-ctrl-topic .gdfar-ctrl-checkbox",r=l(this).parent(),t=l(this).closest(".bbp-topics"),e=l(".gdfar-bulk-topic-"+r.data("key")),d=l(a+":checked",t).length,o=l(a,t).length;0===d?(l(a,t).removeClass("gdfar-is-on"),e.hide()):(l(a,t).addClass("gdfar-is-on"),e.show(),wp.gdfar.manager.bulk.update(e,d,o))}},init:function(){l(r).on("change",".gdfar-ctrl-topic .gdfar-ctrl-checkbox",wp.gdfar.manager.bulk.topic),l(r).on("change",".gdfar-ctrl-forum .gdfar-ctrl-checkbox",wp.gdfar.manager.bulk.forum),l(r).on("click","#gdfar-modal-edit-submit",wp.gdfar.manager.edit.submit),l(r).on("click","#gdfar-modal-bulk-submit",wp.gdfar.manager.bulk.submit),l(r).on("click",".gdfar-ctrl-wrapper .gdfar-ctrl-edit",wp.gdfar.manager.edit.dialog),l(r).on("click",".gdfar-bulk-control .gdfar-ctrl-bulk",wp.gdfar.manager.bulk.dialog),l(r).on("click",".gdfar-bulk-control a.__all, .gdfar-bulk-control a.__none",wp.gdfar.manager.bulk.select)}},wp.gdfar.manager.init()}(jQuery,window,document);